{"version":3,"sources":["../src/OperationExpressionBuilder.js"],"names":["OperationExpressionBuilder","type","property","rootExpression","currentExpression","propertyName","Error","results","propertyAccessExpression","_createPropertyAccessExpression","Array","isArray","constant","_getConstant","operationExpression","OperationExpression","children","push","Queryable","queryableExpression","ValueExpression","getQuery","lambda","propertyNavigationExpression","_createPropertyNavigationExpression","expressionBuilder","ExpressionBuilder","expression","expressionExpression","lambdaExpression","value","Expression","Date","_createOperationExpression","array","_createResultsOperationExpression","propertyNavigation"],"mappings":"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","file":"OperationExpressionBuilder.js","sourcesContent":["import ValueExpression from \"./ValueExpression\";\nimport OperationExpression from \"./OperationExpression\";\nimport Expression from \"./Expression\";\nimport ExpressionBuilder from \"./ExpressionBuilder\";\nimport Queryable from \"./Queryable\";\n\nexport default class OperationExpressionBuilder {\n    constructor(type, property, rootExpression, currentExpression) {\n        this.type = type;\n        this.propertyName = property;\n        this.rootExpression = rootExpression;\n        this.currentExpression = currentExpression || rootExpression;\n\n        if (type == null) {\n            throw new Error(\"Null Argument Exception: type cannot be null.\");\n        }\n\n        if (rootExpression == null) {\n            throw new Error(\"Null Argement Exception: rootExpression cannot be null.\");\n        }\n    }\n\n    _createResultsOperationExpression(type, results) {\n        let propertyAccessExpression = this._createPropertyAccessExpression();\n\n        if (Array.isArray(results)) {\n            let constant = this._getConstant(results);\n            let operationExpression = new OperationExpression(type);\n            operationExpression.children.push(propertyAccessExpression, constant);\n\n            this.currentExpression.children.push(operationExpression);\n            return this.rootExpression;\n        } else if (results instanceof Queryable) {\n            let operationExpression = new OperationExpression(type);\n            let queryableExpression = new ValueExpression(\"queryable\", results.getQuery());\n\n            operationExpression.children.push(propertyAccessExpression, queryableExpression);\n\n            this.currentExpression.children.push(operationExpression);\n            return this.rootExpression;\n        } else {\n            throw new Error(\"Invalid Argument: Expected an array or a queryable.\");\n        }\n    }\n\n    _createLambdaOperationExpression(type, lambda) {\n        if (typeof lambda !== \"function\") {\n            throw new Error(\"Invalid Argument: Expected a function.\");\n        }\n\n        let propertyNavigationExpression = this._createPropertyNavigationExpression();\n\n        let expressionBuilder = new ExpressionBuilder();\n        let expression = lambda(expressionBuilder);\n        let expressionExpression = new OperationExpression(\"expression\");\n\n        expressionExpression.children.push(expression);\n\n        let lambdaExpression = new OperationExpression(type);\n        lambdaExpression.children.push(\n            propertyNavigationExpression,\n            expressionExpression\n        );\n\n        this.currentExpression.children.push(lambdaExpression);\n\n        return this.rootExpression;\n    }\n\n    _createOperationExpression(type, value) {\n        let propertyAccessExpression = this._createPropertyAccessExpression();\n\n        let constant = this._getConstant(value);\n        let expression = new OperationExpression(type);\n        expression.children.push(propertyAccessExpression, constant);\n\n        this.currentExpression.children.push(expression);\n\n        return this.rootExpression;\n    }\n\n    _createPropertyAccessExpression() {\n        let propertyAccessExpression = new OperationExpression(\"propertyAccess\");\n        propertyAccessExpression.children.push(\n            new ValueExpression(\"type\", this.type),\n            new ValueExpression(\"property\", this.propertyName)\n        );\n\n        return propertyAccessExpression;\n    }\n\n    _createPropertyNavigationExpression() {\n        let propertyNavigationExpression = new OperationExpression(\"propertyNavigation\");\n        propertyNavigationExpression.children.push(\n            new ValueExpression(\"type\", this.type),\n            new ValueExpression(\"property\", this.propertyName)\n        );\n\n        return propertyNavigationExpression;\n    }\n\n    _getConstant(value) {\n        if (value instanceof Expression) {\n            return value;\n        }\n\n        if (typeof value === \"string\") {\n            return new ValueExpression(\"string\", value);\n        } else if (typeof value === \"function\") {\n            return new ValueExpression(\"function\", value);\n        } else if (typeof value === \"number\") {\n            return new ValueExpression(\"number\", value);\n        } else if (typeof value === \"boolean\") {\n            return new ValueExpression(\"boolean\", value);\n        } else if (value === null) {\n            return new ValueExpression(\"null\", value);\n        } else if (Array.isArray(value)) {\n            return new ValueExpression(\"array\", value);\n        } else if (value instanceof Date) {\n            return new ValueExpression(\"date\", value);\n        } else {\n            return new ValueExpression(\"object\", value);\n        }\n    }\n\n    contains(value) {\n        return this._createOperationExpression(\"contains\", value);\n    }\n\n    isEqualTo(value) {\n        return this._createOperationExpression(\"isEqualTo\", value);\n    }\n\n    isNotEqualTo(value) {\n        return this._createOperationExpression(\"isNotEqualTo\", value);\n    }\n\n    isIn(array) {\n        return this._createResultsOperationExpression(\"isIn\", array);\n    }\n\n    isNotIn(array) {\n        return this._createResultsOperationExpression(\"isNotIn\", array);\n    }\n\n    isGreaterThan(value) {\n        return this._createOperationExpression(\"isGreaterThan\", value);\n    }\n\n    isGreaterThanOrEqualTo(value) {\n        return this._createOperationExpression(\"isGreaterThanOrEqualTo\", value);\n    }\n\n    isLessThanOrEqualTo(value) {\n        return this._createOperationExpression(\"isLessThanOrEqualTo\", value);\n    }\n\n    isLessThan(value) {\n        return this._createOperationExpression(\"isLessThan\", value);\n    }\n\n    endsWith(value) {\n        return this._createOperationExpression(\"endsWith\", value);\n    }\n\n    startsWith(value) {\n        return this._createOperationExpression(\"startsWith\", value);\n    }\n\n    property(value) {\n        let propertyNavigation = this._createPropertyNavigationExpression();\n        this.currentExpression.children.push(propertyNavigation);\n        return new OperationExpressionBuilder(\"Object\", value, this.rootExpression, propertyNavigation);\n    }\n\n    getExpression() {\n        let propertyAccessExpression = this._createPropertyAccessExpression();\n        this.currentExpression.children.push(propertyAccessExpression);\n\n        return this.rootExpression;\n    }\n}"]}